LAB_07D4:
    MOVE.L  LAB_231C,D0
    LSL.L   #2,D0
    ADD.L   LAB_231C,D0
    LEA     LAB_231D,A0
    ADDA.L  D0,A0
    MOVE.B  1(A0),LAB_21FA
    MOVEQ   #0,D0
    MOVE.B  LAB_21ED,D0
    SUBQ.W  #3,D0
    BEQ.S   LAB_07D9

    SUBI.W  #10,D0
    BEQ.S   LAB_07D6

    SUBI.W  #14,D0
    BEQ.S   LAB_07D5

    SUBI.W  #$80,D0
    BEQ.S   LAB_07DA

    BRA.S   LAB_07DB

LAB_07D5:
    MOVEQ   #0,D0
    BRA.S   LAB_07DC

LAB_07D6:
    MOVE.L  LAB_21E8,D0
    CMPI.L  #$6,D0
    BCC.S   LAB_07D9

    ADD.W   D0,D0
    MOVE.W  LAB_07D7(PC,D0.W),D0
    JMP     LAB_07D7+2(PC,D0.W)

; Another jump table for switch
LAB_07D7:
    DC.W    LAB_07D7_000A-LAB_07D7-2
    DC.W    LAB_07D7_000E-LAB_07D7-2
	DC.W    LAB_07D7_0012-LAB_07D7-2
    DC.W    LAB_07D7_0016-LAB_07D7-2
	DC.W    LAB_07D7_001A-LAB_07D7-2
    DC.W    LAB_07D7_001E-LAB_07D7-2

LAB_07D7_000A:
    MOVEQ   #1,D0
    BRA.S   LAB_07DC

LAB_07D7_000E:
    MOVEQ   #2,D0
    BRA.S   LAB_07DC

LAB_07D7_0012:
    MOVEQ   #3,D0
    BRA.S   LAB_07DC

LAB_07D7_0016:
    MOVEQ   #4,D0
    BRA.S   LAB_07DC

LAB_07D7_001A:
    MOVEQ   #5,D0
    BRA.S   LAB_07DC

LAB_07D7_001E:
    MOVEQ   #6,D0
    BRA.S   LAB_07DC

LAB_07D9:
    MOVEQ   #8,D0
    BRA.S   LAB_07DC

LAB_07DA:
    MOVE.B  LAB_21FA,D0
    MOVEQ   #65,D1
    CMP.B   D1,D0
    BNE.S   LAB_07DB

    MOVEQ   #9,D0
    BRA.S   LAB_07DC

LAB_07DB:
    MOVEQ   #10,D0

LAB_07DC:
    RTS

;!======

LAB_07DD:
    MOVE.L  D7,-(A7)
    MOVEQ   #0,D0
    MOVE.B  LAB_21ED,D0
    SUBI.W  #$59,D0
    BEQ.S   LAB_07DE

    SUBI.W  #$20,D0
    BNE.S   LAB_07DF

LAB_07DE:
    MOVEQ   #0,D7
    BRA.S   LAB_07E0

LAB_07DF:
    MOVEQ   #1,D7

LAB_07E0:
    MOVE.L  D7,D0
    MOVE.L  (A7)+,D7
    RTS

;!======

DRAW_BOTTOM_HELP_FOR_ESC_MENU:
    MOVE.B  #$1,LAB_1D13
    BSR.W   LAB_07E4

    ; this might actually end up drawing all the text..
    BSR.W   DRAW_BOTTOM_HELP_TEXT_FOR_ESC_MENU

    RTS

;!======

LAB_07E2:
    LINK.W  A5,#-4
    MOVEA.L LAB_2216,A0
    ADDA.W  #((GLOB_REF_RASTPORT_2-LAB_2216)+2),A0
    MOVE.L  A0,-4(A5)
    MOVEA.L A0,A1
    MOVEQ   #0,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetDrMd(A6)

    MOVEA.L -4(A5),A1
    MOVEQ   #1,D0
    JSR     _LVOSetAPen(A6)

    MOVEQ   #14,D0
    CMP.L   LAB_226E,D0
    BNE.S   LAB_07E3

    MOVEA.L -4(A5),A1
    MOVEQ   #1,D0
    JSR     _LVOSetDrMd(A6)

    MOVEA.L -4(A5),A1
    MOVEQ   #2,D0
    JSR     _LVOSetBPen(A6)

LAB_07E3:
    UNLK    A5
    RTS

;!======

LAB_07E4:
    MOVEM.L D2-D3,-(A7)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #2,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetAPen(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #40,D0
    MOVEQ   #68,D1
    MOVE.L  #680,D2
    MOVE.L  #429,D3
    JSR     _LVORectFill(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    JSR     _LVOSetAPen(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    JSR     _LVOSetDrMd(A6)

    MOVEM.L (A7)+,D2-D3
    RTS

;!======

LAB_07E5:
    PEA     6.W
    BSR.W   LAB_07E9

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetAPen(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #0,D0
    JSR     _LVOSetDrMd(A6)

    PEA     GLOB_STR_EDIT_ADS
    PEA     90.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_EDIT_ATTRIBUTES
    PEA     120.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_CHANGE_SCROLL_SPEED
    PEA     150.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_DIAGNOSTIC_MODE
    PEA     180.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    LEA     68(A7),A7
    PEA     GLOB_STR_SPECIAL_FUNCTIONS
    PEA     210.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_VERSIONS_SCREEN
    PEA     240.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    LEA     32(A7),A7
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetDrMd(A6)

    RTS

;!======

DRAW_BOTTOM_HELP_TEXT_FOR_ESC_MENU:
    PEA     6.W
    BSR.W   DRAW_SOME_RECTANGLES

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #0,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetDrMd(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    JSR     _LVOSetAPen(A6)

    PEA     GLOB_STR_PUSH_ESC_TO_RESUME
    PEA     330.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_PUSH_RETURN_TO_ENTER_SELECTION_1
    PEA     360.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_PUSH_ANY_KEY_TO_SELECT_1
    PEA     390.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetDrMd(A6)

    CLR.L   LAB_21E8
    BSR.W   LAB_07E5

    LEA     52(A7),A7
    RTS

;!======

; Draw the debug strings used in diagnostic mode
DRAW_DIAGNOSTIC_MODE_TEXT:
    MOVEA.L GLOB_REF_RASTPORT_1,A1

    MOVEQ   #1,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetAPen(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    JSR     _LVOSetDrMd(A6)

    PEA     GLOB_STR_VIN_BCK_FWD_SSPD_AD_LINE
    PEA     300.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_TZ_DST_CONT_TXT_GRPH
    PEA     330.W
    PEA     90.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    LEA     32(A7),A7
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #3,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetAPen(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #100,D0
    MOVE.L  #300,D1
    JSR     _LVOMove(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    LEA     LAB_1DD7,A0
    MOVEQ   #(LAB_1DC7_Length),D0
    JSR     _LVOText(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #95,D0
    ADD.L   D0,D0
    MOVE.L  #300,D1
    JSR     _LVOMove(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    LEA     LAB_1DC8,A0
    MOVEQ   #(LAB_1DC8_Length),D0
    JSR     _LVOText(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVE.L  #280,D0
    MOVE.L  #300,D1
    JSR     _LVOMove(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    LEA     LAB_1DC9,A0
    MOVEQ   #(LAB_1DC9_Length),D0
    JSR     _LVOText(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVE.L  #385,D0
    MOVE.L  #300,D1
    JSR     _LVOMove(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    LEA     GLOB_STR_SATELLITE_DELIVERED_SCROLL_SPEED,A0
    MOVEQ   #(GLOB_STR_SATELLITE_DELIVERED_SCROLL_SPEED_Length),D0
    JSR     _LVOText(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVE.L  #475,D0
    MOVE.L  #300,D1
    JSR     _LVOMove(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    LEA     LAB_1DCB,A0
    MOVEQ   #(LAB_1DCB_Length),D0
    JSR     _LVOText(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVE.L  #595,D0
    MOVE.L  #300,D1
    JSR     _LVOMove(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    LEA     LAB_1DCD,A0
    MOVEQ   #(LAB_1DCD_Length),D0
    JSR     _LVOText(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #75,D0
    ADD.L   D0,D0
    MOVE.L  #330,D1
    JSR     _LVOMove(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    LEA     LAB_1DD1,A0
    MOVEQ   #1,D0
    JSR     _LVOText(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #120,D0
    ADD.L   D0,D0
    MOVE.L  #330,D1
    JSR     _LVOMove(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    LEA     LAB_1DD2,A0
    MOVEQ   #1,D0
    JSR     _LVOText(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVE.L  #345,D0
    MOVE.L  #330,D1
    JSR     _LVOMove(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    LEA     LAB_1DD3,A0
    MOVEQ   #1,D0
    JSR     _LVOText(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVE.L  #450,D0
    MOVE.L  #330,D1
    JSR     _LVOMove(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    LEA     LAB_1BC4,A0
    MOVEQ   #1,D0
    JSR     _LVOText(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVE.L  #555,D0
    MOVE.L  #330,D1
    JSR     _LVOMove(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    LEA     LAB_1DD6,A0
    MOVEQ   #1,D0
    JSR     _LVOText(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    JSR     _LVOSetAPen(A6)

    RTS

;!======

; Rename this when i know what it actually is drawing
DRAW_SOME_RECTANGLES:
    MOVEM.L D2-D3/D7,-(A7)
    MOVE.L  16(A7),D7

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #2,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetAPen(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #40,D0
    MOVEQ   #68,D1
    MOVE.L  #640,D2
    MOVE.L  #297,D3
    JSR     _LVORectFill(A6)

    MOVE.L  D7,D0
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    JSR     _LVOSetAPen(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #40,D0
    MOVE.L  #298,D1
    ; D2 is still 640
    MOVE.L  #429,D3
    JSR     _LVORectFill(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #0,D0
    JSR     _LVOSetDrMd(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    JSR     _LVOSetAPen(A6)

    MOVEM.L (A7)+,D2-D3/D7
    RTS

;!======

LAB_07E9:
    MOVEM.L D2-D3/D7,-(A7)

    MOVE.L  16(A7),D7
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #2,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetAPen(A6)

    MOVE.L  D7,D0
    MOVEQ   #30,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    MOVEQ   #67,D1
    ADD.L   D1,D0
    MOVE.L  D0,D3
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #40,D0
    MOVEQ   #68,D1
    MOVE.L  #640,D2
    JSR     _LVORectFill(A6)

    CMPI.L  #$ffffffff,LAB_21E8
    BLE.S   .LAB_07EA

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #6,D0
    JSR     _LVOSetAPen(A6)

    MOVE.L  LAB_21E8,D0
    MOVEQ   #30,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    MOVE.L  D0,D1
    MOVEQ   #68,D2
    ADD.L   D2,D1
    MOVEQ   #97,D2
    ADD.L   D2,D0
    MOVE.L  D0,D3
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #40,D0
    MOVE.L  #640,D2
    JSR     _LVORectFill(A6)

.LAB_07EA:
    MOVEM.L (A7)+,D2-D3/D7
    RTS

;!======

; Draw the ESC -> Diagnostic Mode text
LAB_07EB:
    MOVEM.L D2-D3,-(A7)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #2,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetAPen(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #40,D0
    MOVEQ   #68,D1
    MOVE.L  #640,D2
    MOVE.L  #327,D3
    JSR     _LVORectFill(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #6,D0
    JSR     _LVOSetAPen(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #40,D0
    MOVE.L  #328,D1
    MOVE.L  #429,D3
    JSR     _LVORectFill(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #0,D0
    JSR     _LVOSetDrMd(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    JSR     _LVOSetAPen(A6)

    PEA     GLOB_STR_PUSH_RETURN_TO_ENTER_SELECTION_3
    PEA     390.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_PUSH_ANY_KEY_TO_SELECT_2
    PEA     420.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    LEA     32(A7),A7
    MOVEM.L (A7)+,D2-D3
    RTS

;!======

; draw esc - change scroll speed menu text
LAB_07EC:
    LINK.W  A5,#-80

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetAPen(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #0,D0
    JSR     _LVOSetDrMd(A6)

    MOVEQ   #0,D0
    MOVE.B  GLOB_STR_SATELLITE_DELIVERED_SCROLL_SPEED,D0         ; '3'
    MOVE.L  D0,-(A7)
    PEA     GLOB_STR_SATELLITE_DELIVERED_SCROLL_SPEED_PCT_C
    PEA     -80(A5)
    JSR     GROUPB_JMP_TBL_WDISP_SPrintf(PC)

    PEA     -80(A5)
    PEA     90.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_SPEED_ZERO_NOT_AVAILABLE
    PEA     120.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_SPEED_ONE_NOT_AVAILABLE
    PEA     150.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_SCROLL_SPEED_2
    PEA     180.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    LEA     76(A7),A7

    PEA     GLOB_STR_SCROLL_SPEED_3
    PEA     210.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_SCROLL_SPEED_4
    PEA     240.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_SCROLL_SPEED_5
    PEA     270.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_SCROLL_SPEED_6
    PEA     300.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_SCROLL_SPEED_7
    PEA     330.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    LEA     80(A7),A7
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetDrMd(A6)

    UNLK    A5
    RTS

;!======

DRAW_ESC_SPECIAL_FUNCTIONS_MENU_TEXT:
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetAPen(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #0,D0
    JSR     _LVOSetDrMd(A6)

    PEA     GLOB_STR_SAVE_ALL_TO_DISK
    PEA     90.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_SAVE_DATA_TO_DISK
    PEA     120.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_LOAD_TEXT_ADS_FROM_DISK
    PEA     150.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_REBOOT_COMPUTER
    PEA     180.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    LEA     64(A7),A7

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetDrMd(A6)

    RTS

;!======

LAB_07EE:
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetDrMd(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    JSR     _LVOSetAPen(A6)

    PEA     GLOB_STR_REGISTER
    PEA     240.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     2.W
    MOVE.L  LAB_21EE,-(A7)
    PEA     LAB_21F0
    JSR     LAB_085B(PC)

    PEA     LAB_21F0
    PEA     240.W
    PEA     190.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_R_EQUALS
    PEA     270.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    MOVE.L  LAB_21EE,D0
    LSL.L   #2,D0
    SUB.L   LAB_21EE,D0
    LEA     LAB_1DE0,A0
    ADDA.L  D0,A0
    MOVEQ   #0,D0
    MOVE.B  (A0),D0
    PEA     2.W
    MOVE.L  D0,-(A7)
    PEA     LAB_21F0
    JSR     LAB_085B(PC)

    LEA     72(A7),A7
    PEA     LAB_21F0
    PEA     270.W
    PEA     85.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_G_EQUALS
    PEA     270.W
    PEA     135.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    MOVE.L  LAB_21EE,D0
    LSL.L   #2,D0
    SUB.L   LAB_21EE,D0
    LEA     LAB_1DE1,A0
    ADDA.L  D0,A0
    MOVEQ   #0,D0
    MOVE.B  (A0),D0
    PEA     2.W
    MOVE.L  D0,-(A7)
    PEA     LAB_21F0
    JSR     LAB_085B(PC)

    PEA     LAB_21F0
    PEA     270.W
    PEA     180.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_B_EQUALS
    PEA     270.W
    PEA     230.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    LEA     76(A7),A7
    MOVE.L  LAB_21EE,D0
    LSL.L   #2,D0
    SUB.L   LAB_21EE,D0
    LEA     LAB_1DE2,A0
    ADDA.L  D0,A0
    MOVEQ   #0,D0
    MOVE.B  (A0),D0
    PEA     2.W
    MOVE.L  D0,-(A7)
    PEA     LAB_21F0
    JSR     LAB_085B(PC)

    PEA     LAB_21F0
    PEA     270.W
    PEA     275.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    LEA     28(A7),A7
    RTS

;!======

LAB_07EF:
    PEA     6.W
    BSR.W   DRAW_SOME_RECTANGLES

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #0,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetDrMd(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    JSR     _LVOSetAPen(A6)

    PEA     GLOB_STR_ARE_YOU_SURE
    PEA     330.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    LEA     20(A7),A7
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetDrMd(A6)

    RTS

;!======

; enter ad number prompt
LAB_07F0:
    LINK.W  A5,#-4
    MOVEM.L D2-D3/D7,-(A7)

    PEA     6.W
    BSR.W   DRAW_SOME_RECTANGLES

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #0,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetDrMd(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    JSR     _LVOSetAPen(A6)

    PEA     GLOB_STR_ENTER_AD_NUMBER_ONE_HYPHEN
    PEA     330.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     2.W
    MOVE.L  LAB_21FD,-(A7)
    PEA     LAB_21F0
    JSR     LAB_085B(PC)

    PEA     LAB_21F0
    PEA     330.W
    PEA     340.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_LEFT_PARENTHESIS_THEN
    PEA     330.W
    PEA     370.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_PUSH_RETURN_TO_ENTER_SELECTION_2
    PEA     360.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    LEA     80(A7),A7
    PEA     GLOB_STR_SINGLE_SPACE_4
    PEA     390.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetDrMd(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #6,D0
    JSR     _LVOSetAPen(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #40,D0
    MOVEQ   #68,D1
    MOVE.L  #640,D2
    MOVEQ   #98,D3
    JSR     _LVORectFill(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    JSR     _LVOSetAPen(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #0,D0
    JSR     _LVOSetDrMd(A6)

    PEA     GLOB_STR_AD_NUMBER_QUESTIONMARK
    PEA     90.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    LEA     32(A7),A7
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetDrMd(A6)

    MOVEQ   #12,D0
    MOVE.L  D0,LAB_21E8
    MOVEQ   #0,D7

LAB_07F1:
    MOVEQ   #14,D0
    CMP.L   D0,D7
    BGE.S   LAB_07F2

    LEA     LAB_21F0,A0
    ADDA.L  D7,A0
    MOVE.B  #$20,(A0)
    LEA     LAB_21F7,A0
    ADDA.L  D7,A0
    PEA     1.W
    PEA     2.W
    MOVE.L  A0,20(A7)
    JSR     LAB_0858(PC)

    ADDQ.W  #8,A7
    MOVEA.L 12(A7),A0
    MOVE.B  D0,(A0)
    ADDQ.L  #1,D7
    BRA.S   LAB_07F1

LAB_07F2:
    CLR.B   LAB_21F4
    BSR.W   LAB_07F3

    MOVEM.L (A7)+,D2-D3/D7
    UNLK    A5
    RTS

;!======

LAB_07F3:
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #5,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetDrMd(A6)

    BSR.W   LAB_07F4

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetDrMd(A6)

    RTS

;!======

LAB_07F4:
    LINK.W  A5,#-4
    LEA     LAB_21F7,A0
    ADDA.L  LAB_21E8,A0
    MOVEQ   #0,D0
    MOVE.B  (A0),D0
    MOVE.L  D0,-(A7)
    JSR     LAB_0859(PC)

    MOVEQ   #0,D1
    MOVE.B  D0,D1
    MOVE.L  D1,D0
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetAPen(A6)

    LEA     LAB_21F7,A0
    ADDA.L  LAB_21E8,A0
    MOVEQ   #0,D0
    MOVE.B  (A0),D0
    MOVE.L  D0,(A7)
    JSR     LAB_085D(PC)

    MOVEQ   #0,D1
    MOVE.B  D0,D1
    MOVE.L  D1,D0
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetBPen(A6)

    MOVE.L  LAB_21E8,(A7)
    BSR.W   LAB_07F5

    ADDQ.W  #4,A7
    MOVE.L  LAB_2200,D0
    LSL.L   #4,D0
    SUB.L   LAB_2200,D0
    MOVEQ   #40,D1
    ADD.L   D1,D0
    MOVE.L  D0,0(A7)
    MOVE.L  LAB_21E9,D0
    MOVEQ   #30,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    MOVEQ   #90,D1
    ADD.L   D1,D0
    MOVE.L  D0,D1
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVE.L  0(A7),D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOMove(A6)

    LEA     LAB_21F0,A0
    ADDA.L  LAB_21E8,A0
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    JSR     _LVOText(A6)

    UNLK    A5
    RTS

;!======

LAB_07F5:
    MOVE.L  D7,-(A7)
    MOVE.L  8(A7),D7
    MOVE.L  D7,D0
    MOVEQ   #40,D1
    JSR     GROUPB_JMP_TBL_LAB_1A07(PC)

    MOVE.L  D1,LAB_2200
    MOVE.L  D7,D0
    MOVEQ   #40,D1
    JSR     GROUPB_JMP_TBL_LAB_1A07(PC)

    MOVE.L  D0,LAB_21E9

.LAB_07F6:
    MOVE.L  LAB_21E9,D0
    CMP.L   LAB_21FB,D0
    BLT.S   .return

    SUBQ.L  #1,LAB_21E9
    MOVEQ   #40,D0
    SUB.L   D0,LAB_21E8
    BRA.S   .LAB_07F6

.return:
    MOVE.L  (A7)+,D7
    RTS

;!======

LAB_07F8:
    LINK.W  A5,#-44
    MOVEM.L D2-D3/D6-D7,-(A7)

    MOVE.B  11(A5),D7
    MOVEQ   #0,D0
    MOVE.B  D7,D0
    MOVE.L  D0,-(A7)
    JSR     LAB_085D(PC)

    MOVE.L  D0,D6
    MOVEQ   #0,D0
    MOVE.B  D6,D0
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetAPen(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #102,D0
    ADD.L   D0,D0
    MOVEQ   #125,D1
    ADD.L   D1,D1
    MOVE.L  #474,D2
    MOVE.L  #275,D3
    JSR     _LVORectFill(A6)

    MOVEQ   #0,D0
    MOVE.B  D7,D0
    MOVE.L  D0,(A7)
    JSR     LAB_0859(PC)

    MOVEQ   #0,D1
    MOVE.B  D0,D1
    MOVE.L  D1,D0
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetAPen(A6)

    MOVEQ   #0,D0
    MOVE.B  D6,D0
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    JSR     _LVOSetBPen(A6)

    MOVEQ   #0,D0
    MOVE.B  D7,D0
    MOVE.L  D0,(A7)
    PEA     GLOB_STR_CURRENT_COLOR_FORMATTED
    PEA     -41(A5)
    JSR     GROUPB_JMP_TBL_WDISP_SPrintf(PC)

    PEA     -41(A5)
    PEA     272.W
    PEA     205.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetAPen(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #2,D0
    JSR     _LVOSetBPen(A6)

    MOVEM.L -60(A5),D2-D3/D6-D7
    UNLK    A5
    RTS

;!======

SET_A_PEN_1_B_PEN_6_DRMD_1_DRAW_TEXT_OR_CURSOR:
    MOVE.L  D7,-(A7)

    MOVE.L  8(A7),D7
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetAPen(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #6,D0
    JSR     _LVOSetBPen(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    JSR     _LVOSetDrMd(A6)

    MOVEQ   #1,D0
    CMP.L   D0,D7
    BNE.S   .setTextToCursor

    LEA     GLOB_STR_TEXT,A0
    BRA.S   .drawText

.setTextToCursor:
    LEA     GLOB_STR_CURSOR,A0

.drawText:
    MOVE.L  A0,-(A7)
    PEA     390.W
    PEA     296.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    LEA     16(A7),A7
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #2,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetBPen(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #0,D0
    JSR     _LVOSetDrMd(A6)

    MOVE.L  (A7)+,D7
    RTS

;!======

SET_A_PEN_1_B_PEN_6_DRMD_1_DRAW_LINE_OR_PAGE:
    LINK.W  A5,#0

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0

    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetAPen(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #6,D0
    JSR     _LVOSetBPen(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    JSR     _LVOSetDrMd(A6)

    TST.L   GLOB_REF_BOOL_IS_LINE_OR_PAGE
    BNE.S   .setTextToPage

    LEA     GLOB_STR_LINE,A0
    BRA.S   .drawText

.setTextToPage:
    LEA     GLOB_STR_PAGE,A0

.drawText:
    MOVE.L  A0,-(A7)
    PEA     390.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #2,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetBPen(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #0,D0
    JSR     _LVOSetDrMd(A6)

    UNLK    A5
    RTS

;!======

LAB_07FF:
    MOVE.L  GLOB_REF_LONG_CURRENT_EDITING_AD_NUMBER,D0
    CMP.L   LAB_21FD,D0
    BGE.S   .LAB_0800

    BSR.W   LAB_0805

    ADDQ.L  #1,GLOB_REF_LONG_CURRENT_EDITING_AD_NUMBER
    BSR.W   LAB_0803

.LAB_0800:
    RTS

;!======

LAB_0801:
    CMPI.L  #1,GLOB_REF_LONG_CURRENT_EDITING_AD_NUMBER
    BLE.S   .return

    BSR.W   LAB_0805

    SUBQ.L  #1,GLOB_REF_LONG_CURRENT_EDITING_AD_NUMBER
    BSR.W   LAB_0803

.return:
    RTS

;!======

LAB_0803:
    LINK.W  A5,#-40

    MOVE.L  GLOB_REF_LONG_CURRENT_EDITING_AD_NUMBER,-(A7)
    PEA     GLOB_STR_AD_NUMBER_FORMATTED
    PEA     -40(A5)
    JSR     GROUPB_JMP_TBL_WDISP_SPrintf(PC)

    PEA     -40(A5)
    PEA     180.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    LEA     28(A7),A7
    MOVEQ   #0,D0
    MOVE.L  D0,LAB_21EA
    MOVE.L  GLOB_REF_LONG_CURRENT_EDITING_AD_NUMBER,D1
    ASL.L   #2,D1
    LEA     LAB_2250,A0
    ADDA.L  D1,A0
    MOVEA.L (A0),A1
    MOVE.W  (A1),D1
    TST.W   D1
    BLE.S   .LAB_0804

    MOVEQ   #1,D1
    MOVE.L  D1,LAB_21EA

.LAB_0804:
    MOVEQ   #1,D1
    MOVE.L  D1,LAB_21FE
    MOVE.L  D0,LAB_21E9
    MOVEQ   #-1,D0
    MOVE.L  D0,LAB_2202
    MOVE.L  D0,LAB_2201
    MOVE.L  D0,LAB_21FF
    BSR.W   LAB_080E

    UNLK    A5
    RTS

;!======

LAB_0805:
    MOVEM.L D2/A2,-(A7)

    TST.L   LAB_21EA
    BNE.S   .LAB_0806

    MOVE.L  GLOB_REF_LONG_CURRENT_EDITING_AD_NUMBER,D0
    MOVE.L  D0,D1
    ASL.L   #2,D1
    LEA     LAB_2250,A0
    MOVEA.L A0,A1
    ADDA.L  D1,A1
    MOVEA.L (A1),A2
    MOVEQ   #0,D2
    MOVE.W  D2,(A2)
    MOVEA.L A0,A1
    ADDA.L  D1,A1
    MOVEA.L (A1),A2
    MOVE.W  D2,2(A2)
    BRA.S   .return

.LAB_0806:
    MOVE.L  GLOB_REF_LONG_CURRENT_EDITING_AD_NUMBER,D0
    ASL.L   #2,D0
    LEA     LAB_2250,A0
    MOVEA.L A0,A1
    ADDA.L  D0,A1
    MOVEA.L (A1),A2
    MOVE.W  #1,(A2)
    ADDA.L  D0,A0
    MOVEA.L (A0),A1
    MOVE.W  #$30,2(A1)

.return:
    MOVEM.L (A7)+,D2/A2
    RTS

;!======

LAB_0808:
    MOVEM.L D2-D3/D7,-(A7)

    MOVE.L  LAB_21E8,D7
    MOVEQ   #0,D0
    MOVE.B  LAB_21F7,D0
    MOVE.L  D0,-(A7)
    JSR     LAB_085D(PC)

    ADDQ.W  #4,A7
    MOVEQ   #0,D1
    MOVE.B  D0,D1
    MOVE.L  D1,D0
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetAPen(A6)

    MOVE.L  LAB_21FB,D0
    MOVEQ   #30,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    MOVEQ   #68,D1
    ADD.L   D1,D0
    MOVE.L  D0,D3
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #40,D0
    MOVE.L  #640,D2
    JSR     _LVORectFill(A6)

    CLR.L   LAB_21E8

.LAB_0809:
    MOVE.L  LAB_21E8,D0
    CMP.L   LAB_21EB,D0
    BGE.S   .return

    BSR.W   LAB_07F4

    ADDQ.L  #1,LAB_21E8
    BRA.S   .LAB_0809

.return:
    MOVE.L  D7,LAB_21E8
    MOVEM.L (A7)+,D2-D3/D7
    RTS

;!======

LAB_080B:
    MOVEM.L D6-D7,-(A7)

    MOVE.L  12(A7),D7
    MOVE.L  LAB_21E8,D6
    MOVE.L  D7,D0
    MOVEQ   #40,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    MOVE.L  D0,LAB_21E8

LAB_080C:
    MOVE.L  D7,D0
    ADDQ.L  #1,D0
    MOVEQ   #40,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    MOVE.L  LAB_21E8,D1
    CMP.L   D0,D1
    BGE.S   LAB_080D

    BSR.W   LAB_07F4

    ADDQ.L  #1,LAB_21E8
    BRA.S   LAB_080C

LAB_080D:
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetAPen(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #2,D0
    JSR     _LVOSetBPen(A6)

    MOVE.L  D6,LAB_21E8
    MOVEM.L (A7)+,D6-D7
    RTS

;!======

LAB_080E:
    MOVEM.L D2-D7,-(A7)

    MOVE.L  LAB_21EA,D0
    MOVE.L  LAB_2201,D1
    CMP.L   D0,D1
    BEQ.W   LAB_0811

    SUBQ.L  #1,D0
    BNE.S   LAB_080F

    MOVEQ   #110,D7
    NOT.B   D7
    MOVE.L  #265,D6
    MOVEQ   #40,D5
    MOVEQ   #65,D4
    ADD.L   D4,D4
    BRA.S   LAB_0810

LAB_080F:
    MOVEQ   #40,D7
    MOVEQ   #65,D6
    ADD.L   D6,D6
    MOVEQ   #110,D5
    NOT.B   D5
    MOVE.L  #265,D4

LAB_0810:
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #2,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetAPen(A6)

    MOVE.L  D7,D0
    MOVE.L  D6,D2
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #68,D1
    MOVEQ   #98,D3
    JSR     _LVORectFill(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #6,D0
    JSR     _LVOSetAPen(A6)

    MOVE.L  D5,D0
    MOVE.L  D4,D2
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #68,D1
    JSR     _LVORectFill(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #0,D0
    JSR     _LVOSetDrMd(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    JSR     _LVOSetAPen(A6)

    PEA     GLOB_STR_ACTIVE_INACTIVE
    PEA     90.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    LEA     16(A7),A7
    MOVE.L  LAB_21EA,LAB_2201

LAB_0811:
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetAPen(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    JSR     _LVOSetDrMd(A6)

    MOVEM.L (A7)+,D2-D7
    RTS

;!======

; draw ad editing screen (editing ad)
LAB_0812:
    LINK.W  A5,#-44
    MOVEM.L D2-D3,-(A7)

.printfResult   = -41

    PEA     6.W
    BSR.W   DRAW_SOME_RECTANGLES

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #0,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetDrMd(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    JSR     _LVOSetAPen(A6)

    PEA     GLOB_STR_PUSH_ESC_TO_MAKE_ANOTHER_SELECTION
    PEA     330.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_PUSH_HELP_FOR_OTHER_EDIT_FUNCTIONS
    PEA     360.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_LINE_MODE_ON_TEXT_COLOR_MODE
    PEA     390.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    MOVE.L  GLOB_REF_BOOL_IS_LINE_OR_PAGE,(A7)
    BSR.W   SET_A_PEN_1_B_PEN_6_DRMD_1_DRAW_LINE_OR_PAGE

    MOVE.L  GLOB_REF_BOOL_IS_TEXT_OR_CURSOR,(A7)
    BSR.W   SET_A_PEN_1_B_PEN_6_DRMD_1_DRAW_TEXT_OR_CURSOR

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #7,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetAPen(A6)

    MOVEQ   #8,D0
    SUB.L   LAB_21FB,D0
    MOVEQ   #30,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    MOVE.L  #302,D1
    SUB.L   D0,D1
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #40,D0
    MOVE.L  #640,D2
    MOVE.L  #308,D3
    JSR     _LVORectFill(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    JSR     _LVOSetAPen(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #7,D0
    JSR     _LVOSetBPen(A6)

    MOVE.L  GLOB_REF_LONG_CURRENT_EDITING_AD_NUMBER,(A7)
    PEA     GLOB_STR_EDITING_AD_NUMBER_FORMATTED_1
    PEA     .printfResult(A5)
    JSR     GROUPB_JMP_TBL_WDISP_SPrintf(PC)

    PEA     .printfResult(A5)
    PEA     300.W
    PEA     190.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    LEA     76(A7),A7
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetDrMd(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #2,D0
    JSR     _LVOSetBPen(A6)

    MOVEM.L (A7)+,D2-D3
    UNLK    A5
    RTS

;!======

LAB_0813:
    LINK.W  A5,#-92
    MOVEM.L D2/D6-D7,-(A7)

    MOVE.L  LAB_21E9,D0
    MOVEQ   #40,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    LEA     LAB_21F0,A0
    ADDA.L  D0,A0
    PEA     40.W
    MOVE.L  A0,-(A7)
    PEA     -49(A5)
    JSR     LAB_09C1(PC)

    LEA     12(A7),A7
    MOVE.L  LAB_21E9,D0
    MOVEQ   #40,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    LEA     LAB_21F7,A0
    ADDA.L  D0,A0
    MOVEQ   #39,D0
    LEA     -90(A5),A1

LAB_0814:
    MOVE.B  (A0)+,(A1)+
    DBF     D0,LAB_0814

    MOVEQ   #0,D7

LAB_0815:
    MOVEQ   #40,D0
    CMP.L   D0,D7
    BGE.S   LAB_0816

    MOVEQ   #32,D0
    CMP.B   -49(A5,D7.L),D0
    BNE.S   LAB_0816

    LEA     LAB_21F7,A0
    ADDA.L  LAB_21E8,A0
    MOVE.B  (A0),-90(A5,D7.L)
    ADDQ.L  #1,D7
    BRA.S   LAB_0815

LAB_0816:
    MOVEQ   #0,D6

LAB_0817:
    MOVEQ   #40,D0
    CMP.L   D0,D6
    BGE.S   LAB_0818

    MOVEQ   #39,D0
    MOVE.L  D0,D1
    SUB.L   D6,D1
    MOVEQ   #32,D2
    CMP.B   -49(A5,D1.L),D2
    BNE.S   LAB_0818

    SUB.L   D6,D0
    LEA     LAB_21F7,A0
    ADDA.L  LAB_21E8,A0
    MOVE.B  (A0),-90(A5,D0.L)
    ADDQ.L  #1,D6
    BRA.S   LAB_0817

LAB_0818:
    MOVEQ   #40,D0
    CMP.L   D0,D7
    BGE.W   LAB_0821

    MOVE.L  LAB_21E9,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    LEA     LAB_21F0,A0
    ADDA.L  D0,A0
    LEA     -49(A5),A1
    ADDA.L  D7,A1
    MOVEQ   #40,D0
    SUB.L   D7,D0
    BRA.S   LAB_081A

LAB_0819:
    MOVE.B  (A1)+,(A0)+

LAB_081A:
    SUBQ.L  #1,D0
    BCC.S   LAB_0819

    MOVE.L  LAB_21E9,D0
    MOVEQ   #40,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    LEA     LAB_21F7,A0
    ADDA.L  D0,A0
    LEA     -90(A5),A1
    ADDA.L  D7,A1
    MOVEQ   #40,D0
    SUB.L   D7,D0
    BRA.S   LAB_081C

LAB_081B:
    MOVE.B  (A1)+,(A0)+

LAB_081C:
    SUBQ.L  #1,D0
    BCC.S   LAB_081B

    MOVE.L  LAB_21E9,D0
    MOVEQ   #40,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    SUB.L   D7,D0
    LEA     LAB_21F5,A0
    ADDA.L  D0,A0
    MOVE.L  D7,D0
    LEA     -49(A5),A1
    BRA.S   LAB_081E

LAB_081D:
    MOVE.B  (A1)+,(A0)+

LAB_081E:
    SUBQ.L  #1,D0
    BCC.S   LAB_081D

    MOVE.L  LAB_21E9,D0
    MOVEQ   #40,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    SUB.L   D7,D0
    LEA     LAB_21F9,A0
    ADDA.L  D0,A0
    MOVE.L  D7,D0
    LEA     -90(A5),A1
    BRA.S   LAB_0820

LAB_081F:
    MOVE.B  (A1)+,(A0)+

LAB_0820:
    SUBQ.L  #1,D0
    BCC.S   LAB_081F

LAB_0821:
    MOVEM.L (A7)+,D2/D6-D7
    UNLK    A5
    RTS

;!======

LAB_0822:
    LINK.W  A5,#-92
    MOVEM.L D2/D6-D7,-(A7)
    MOVE.L  LAB_21E9,D0
    MOVEQ   #40,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    LEA     LAB_21F0,A0
    ADDA.L  D0,A0
    PEA     40.W
    MOVE.L  A0,-(A7)
    PEA     -49(A5)
    JSR     LAB_09C1(PC)

    LEA     12(A7),A7
    MOVE.L  LAB_21E9,D0
    MOVEQ   #40,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    LEA     LAB_21F7,A0
    ADDA.L  D0,A0
    MOVEQ   #39,D0
    LEA     -90(A5),A1

LAB_0823:
    MOVE.B  (A0)+,(A1)+
    DBF     D0,LAB_0823
    MOVEQ   #0,D7

LAB_0824:
    MOVEQ   #40,D0
    CMP.L   D0,D7
    BGE.S   LAB_0825

    MOVEQ   #39,D0
    MOVE.L  D0,D1
    SUB.L   D7,D1
    MOVEQ   #32,D2
    CMP.B   -49(A5,D1.L),D2
    BNE.S   LAB_0825

    SUB.L   D7,D0
    LEA     LAB_21F7,A0
    ADDA.L  LAB_21E8,A0
    MOVE.B  (A0),-90(A5,D0.L)
    ADDQ.L  #1,D7
    BRA.S   LAB_0824

LAB_0825:
    MOVEQ   #0,D6

LAB_0826:
    MOVEQ   #40,D0
    CMP.L   D0,D6
    BGE.S   LAB_0827

    MOVEQ   #32,D0
    CMP.B   -49(A5,D6.L),D0
    BNE.S   LAB_0827

    LEA     LAB_21F7,A0
    ADDA.L  LAB_21E8,A0
    MOVE.B  (A0),-90(A5,D6.L)
    ADDQ.L  #1,D6
    BRA.S   LAB_0826

LAB_0827:
    MOVEQ   #40,D0
    CMP.L   D0,D7
    BGE.W   LAB_0830

    MOVE.L  LAB_21E9,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    ADD.L   D7,D0
    LEA     LAB_21F0,A0
    ADDA.L  D0,A0
    MOVEQ   #40,D0
    SUB.L   D7,D0
    LEA     -49(A5),A1
    BRA.S   LAB_0829

LAB_0828:
    MOVE.B  (A1)+,(A0)+

LAB_0829:
    SUBQ.L  #1,D0
    BCC.S   LAB_0828

    MOVE.L  LAB_21E9,D0
    MOVEQ   #40,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    ADD.L   D7,D0
    LEA     LAB_21F7,A0
    ADDA.L  D0,A0
    MOVEQ   #40,D0
    SUB.L   D7,D0
    LEA     -90(A5),A1
    BRA.S   LAB_082B

LAB_082A:
    MOVE.B  (A1)+,(A0)+

LAB_082B:
    SUBQ.L  #1,D0
    BCC.S   LAB_082A

    MOVE.L  LAB_21E9,D0
    MOVEQ   #40,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    LEA     LAB_21F0,A0
    ADDA.L  D0,A0
    MOVEQ   #40,D0
    SUB.L   D7,D0
    LEA     -49(A5),A1
    ADDA.L  D0,A1
    MOVE.L  D7,D0
    BRA.S   LAB_082D

LAB_082C:
    MOVE.B  (A1)+,(A0)+

LAB_082D:
    SUBQ.L  #1,D0
    BCC.S   LAB_082C

    MOVE.L  LAB_21E9,D0
    MOVEQ   #40,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    LEA     LAB_21F7,A0
    ADDA.L  D0,A0
    MOVEQ   #40,D0
    SUB.L   D7,D0
    LEA     -90(A5),A1
    ADDA.L  D0,A1
    MOVE.L  D7,D0
    BRA.S   LAB_082F

LAB_082E:
    MOVE.B  (A1)+,(A0)+

LAB_082F:
    SUBQ.L  #1,D0
    BCC.S   LAB_082E

LAB_0830:
    MOVEM.L (A7)+,D2/D6-D7
    UNLK    A5
    RTS

;!======

LAB_0831:
    LINK.W  A5,#-92
    MOVEM.L D2/D6-D7,-(A7)
    MOVE.L  LAB_21E9,D0
    MOVEQ   #40,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    LEA     LAB_21F0,A0
    ADDA.L  D0,A0
    PEA     40.W
    MOVE.L  A0,-(A7)
    PEA     -49(A5)
    JSR     LAB_09C1(PC)

    LEA     12(A7),A7
    MOVE.L  LAB_21E9,D0
    MOVEQ   #40,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    LEA     LAB_21F7,A0
    ADDA.L  D0,A0
    MOVEQ   #39,D0
    LEA     -90(A5),A1

LAB_0832:
    MOVE.B  (A0)+,(A1)+
    DBF     D0,LAB_0832

    MOVEQ   #0,D7

LAB_0833:
    MOVEQ   #40,D0
    CMP.L   D0,D7
    BGE.S   LAB_0834

    MOVEQ   #32,D0
    CMP.B   -49(A5,D7.L),D0
    BNE.S   LAB_0834

    LEA     LAB_21F7,A0
    ADDA.L  LAB_21E8,A0
    MOVE.B  (A0),-90(A5,D7.L)
    ADDQ.L  #1,D7
    BRA.S   LAB_0833

LAB_0834:
    MOVEQ   #0,D6

LAB_0835:
    MOVEQ   #40,D0
    CMP.L   D0,D6
    BGE.S   LAB_0836

    MOVEQ   #39,D0
    MOVE.L  D0,D1
    SUB.L   D6,D1
    MOVEQ   #32,D2
    CMP.B   -49(A5,D1.L),D2
    BNE.S   LAB_0836

    SUB.L   D6,D0
    LEA     LAB_21F7,A0
    ADDA.L  LAB_21E8,A0
    MOVE.B  (A0),-90(A5,D0.L)
    ADDQ.L  #1,D6
    BRA.S   LAB_0835

LAB_0836:
    MOVE.L  D6,D0
    SUBQ.L  #1,D0
    CMP.L   D0,D7
    BGE.W   LAB_0840

    MOVE.L  D6,D0
    SUB.L   D7,D0
    TST.L   D0
    BPL.S   LAB_0837

    ADDQ.L  #1,D0

LAB_0837:
    ASR.L   #1,D0
    MOVE.L  D0,D7
    MOVE.L  LAB_21E9,D0
    MOVEQ   #40,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    ADD.L   D7,D0
    LEA     LAB_21F0,A0
    ADDA.L  D0,A0
    MOVEQ   #40,D0
    SUB.L   D7,D0
    LEA     -49(A5),A1
    BRA.S   LAB_0839

LAB_0838:
    MOVE.B  (A1)+,(A0)+

LAB_0839:
    SUBQ.L  #1,D0
    BCC.S   LAB_0838

    MOVE.L  LAB_21E9,D0
    MOVEQ   #40,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    ADD.L   D7,D0
    LEA     LAB_21F7,A0
    ADDA.L  D0,A0
    MOVEQ   #40,D0
    SUB.L   D7,D0
    LEA     -90(A5),A1
    BRA.S   LAB_083B

LAB_083A:
    MOVE.B  (A1)+,(A0)+

LAB_083B:
    SUBQ.L  #1,D0
    BCC.S   LAB_083A

    MOVE.L  LAB_21E9,D0
    MOVEQ   #40,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    LEA     LAB_21F0,A0
    ADDA.L  D0,A0
    MOVEQ   #40,D0
    SUB.L   D7,D0
    LEA     -49(A5),A1
    ADDA.L  D0,A1
    MOVE.L  D7,D0
    BRA.S   LAB_083D

LAB_083C:
    MOVE.B  (A1)+,(A0)+

LAB_083D:
    SUBQ.L  #1,D0
    BCC.S   LAB_083C

    MOVE.L  LAB_21E9,D0
    MOVEQ   #40,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    LEA     LAB_21F7,A0
    ADDA.L  D0,A0
    MOVEQ   #40,D0
    SUB.L   D7,D0
    LEA     -90(A5),A1
    ADDA.L  D0,A1
    MOVE.L  D7,D0
    BRA.S   LAB_083F

LAB_083E:
    MOVE.B  (A1)+,(A0)+

LAB_083F:
    SUBQ.L  #1,D0
    BCC.S   LAB_083E

    BRA.W   LAB_084A

LAB_0840:
    CMP.L   D6,D7
    BLE.W   LAB_084A

    MOVE.L  D7,D0
    SUB.L   D6,D0
    ADDQ.L  #1,D0
    TST.L   D0
    BPL.S   LAB_0841

    ADDQ.L  #1,D0

LAB_0841:
    ASR.L   #1,D0
    MOVE.L  D0,D7
    MOVE.L  LAB_21E9,D0
    MOVEQ   #40,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    LEA     LAB_21F0,A0
    ADDA.L  D0,A0
    LEA     -49(A5),A1
    ADDA.L  D7,A1
    MOVEQ   #40,D0
    SUB.L   D7,D0
    BRA.S   LAB_0843

LAB_0842:
    MOVE.B  (A1)+,(A0)+

LAB_0843:
    SUBQ.L  #1,D0
    BCC.S   LAB_0842

    MOVE.L  LAB_21E9,D0
    MOVEQ   #40,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    LEA     LAB_21F7,A0
    ADDA.L  D0,A0
    LEA     -90(A5),A1
    ADDA.L  D7,A1
    MOVEQ   #40,D0
    SUB.L   D7,D0
    BRA.S   LAB_0845

LAB_0844:
    MOVE.B  (A1)+,(A0)+

LAB_0845:
    SUBQ.L  #1,D0
    BCC.S   LAB_0844

    MOVE.L  LAB_21E9,D0
    MOVEQ   #40,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    SUB.L   D7,D0
    LEA     LAB_21F5,A0
    ADDA.L  D0,A0
    MOVE.L  D7,D0
    LEA     -49(A5),A1
    BRA.S   LAB_0847

LAB_0846:
    MOVE.B  (A1)+,(A0)+

LAB_0847:
    SUBQ.L  #1,D0
    BCC.S   LAB_0846

    MOVE.L  LAB_21E9,D0
    MOVEQ   #40,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    SUB.L   D7,D0
    LEA     LAB_21F9,A0
    ADDA.L  D0,A0
    MOVE.L  D7,D0
    LEA     -90(A5),A1
    BRA.S   LAB_0849

LAB_0848:
    MOVE.B  (A1)+,(A0)+

LAB_0849:
    SUBQ.L  #1,D0
    BCC.S   LAB_0848

LAB_084A:
    MOVEM.L (A7)+,D2/D6-D7
    UNLK    A5
    RTS

;!======

LAB_084B:
    LINK.W  A5,#-48
    MOVEM.L D2-D3/D7,-(A7)
    MOVE.L  GLOB_REF_LONG_CURRENT_EDITING_AD_NUMBER,D0
    SUBQ.L  #1,D0
    PEA     LAB_21F7
    PEA     LAB_21F0
    MOVE.L  D0,-(A7)
    JSR     LAB_085C(PC)

    LEA     12(A7),A7
    LEA     LAB_21F0,A0
    MOVEA.L A0,A1

LAB_084C:
    TST.B   (A1)+
    BNE.S   LAB_084C

    SUBQ.L  #1,A1
    SUBA.L  A0,A1
    MOVE.L  A1,D7
    MOVE.L  LAB_21EB,D0
    CMP.L   D0,D7
    BGE.S   LAB_0851

    ADDA.L  D7,A0
    SUB.L   D7,D0
    MOVEQ   #32,D1
    BRA.S   LAB_084E

LAB_084D:
    MOVE.B  D1,(A0)+

LAB_084E:
    SUBQ.L  #1,D0
    BCC.S   LAB_084D

    LEA     LAB_21F7,A0
    ADDA.L  D7,A0
    PEA     1.W
    PEA     2.W
    MOVE.L  A0,20(A7)
    JSR     LAB_0858(PC)

    ADDQ.W  #8,A7
    MOVEQ   #0,D1
    MOVE.B  D0,D1
    MOVE.L  LAB_21EB,D0
    SUB.L   D7,D0
    MOVEA.L 12(A7),A0
    BRA.S   LAB_0850

LAB_084F:
    MOVE.B  D1,(A0)+

LAB_0850:
    SUBQ.L  #1,D0
    BCC.S   LAB_084F

LAB_0851:
    LEA     LAB_21F0,A0
    ADDA.L  LAB_21EB,A0
    CLR.B   (A0)
    MOVEQ   #1,D0
    MOVE.L  D0,LAB_21FE
    BSR.W   LAB_0808

    MOVEQ   #0,D0
    MOVE.L  D0,LAB_21E8
    MOVE.L  D0,LAB_21E9
    MOVE.L  D0,GLOB_REF_BOOL_IS_LINE_OR_PAGE
    MOVE.L  D0,-(A7)
    BSR.W   SET_A_PEN_1_B_PEN_6_DRMD_1_DRAW_LINE_OR_PAGE

    MOVEQ   #1,D0
    MOVE.L  D0,GLOB_REF_BOOL_IS_TEXT_OR_CURSOR
    MOVE.L  D0,(A7)
    BSR.W   SET_A_PEN_1_B_PEN_6_DRMD_1_DRAW_TEXT_OR_CURSOR

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #7,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetAPen(A6)

    MOVEQ   #8,D0
    SUB.L   LAB_21FB,D0
    MOVEQ   #30,D1
    JSR     GROUPB_JMP_TBL_LAB_1A06(PC)

    MOVE.L  #302,D1
    SUB.L   D0,D1
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #40,D0
    MOVE.L  #640,D2
    MOVE.L  #308,D3
    JSR     _LVORectFill(A6)

    MOVEQ   #0,D0
    MOVE.B  LAB_21F7,D0
    MOVE.L  D0,(A7)
    BSR.W   LAB_07F8

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetAPen(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #7,D0
    JSR     _LVOSetBPen(A6)

    MOVE.L  GLOB_REF_LONG_CURRENT_EDITING_AD_NUMBER,(A7)
    PEA     GLOB_STR_EDITING_AD_NUMBER_FORMATTED_2
    PEA     -44(A5)
    JSR     GROUPB_JMP_TBL_WDISP_SPrintf(PC)

    PEA     -44(A5)
    PEA     300.W
    PEA     190.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    ; Set drawing mode to 1
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetDrMd(A6)

    ; Set B pen to 2
    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #2,D0
    JSR     _LVOSetBPen(A6)

    BSR.W   LAB_07F3

    MOVEM.L -60(A5),D2-D3/D7
    UNLK    A5
    RTS

;!======

LAB_0852:
    MOVE.L  GLOB_REF_LONG_CURRENT_EDITING_AD_NUMBER,D0
    SUBQ.L  #1,D0
    PEA     LAB_21F7
    PEA     LAB_21F0
    MOVE.L  D0,-(A7)
    JSR     LAB_085A(PC)

    LEA     12(A7),A7
    RTS

;!======

LAB_0853:
    MOVE.L  GLOB_REF_LONG_CURRENT_EDITING_AD_NUMBER,D0
    CMP.L   LAB_21FD,D0
    BGE.S   LAB_0854

    BSR.S   LAB_0852

    ADDQ.L  #1,GLOB_REF_LONG_CURRENT_EDITING_AD_NUMBER
    BSR.W   LAB_084B

LAB_0854:
    RTS

;!======

; Decrement the current ad number being edited
LAB_0855:
    CMPI.L  #$1,GLOB_REF_LONG_CURRENT_EDITING_AD_NUMBER
    BLE.S   .return

    BSR.S   LAB_0852

    SUBQ.L  #1,GLOB_REF_LONG_CURRENT_EDITING_AD_NUMBER
    BSR.W   LAB_084B

.return:
    RTS

;!======

LAB_0857:
    MOVEM.L D2-D3,-(A7)

    BSR.W   LAB_07E4

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #2,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetAPen(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #40,D0
    MOVEQ   #68,D1
    MOVE.L  #$280,D2
    MOVE.L  #$165,D3
    JSR     _LVORectFill(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #6,D0
    JSR     _LVOSetAPen(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #40,D0
    MOVE.L  #$166,D1
    MOVE.L  #$1ad,D3
    JSR     _LVORectFill(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #0,D0
    JSR     _LVOSetDrMd(A6)

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    JSR     _LVOSetAPen(A6)

    PEA     LAB_1DAC
    PEA     390.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     LAB_1DAD
    PEA     90.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     LAB_1DAE
    PEA     120.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     LAB_1DAF
    PEA     150.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     LAB_1DB0
    PEA     180.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    LEA     80(A7),A7
    PEA     LAB_1DB1
    PEA     210.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     LAB_1DB2
    PEA     240.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_SHIFT_RIGHT_NEXT_AD_DEL_DELETE_CHAR
    PEA     270.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_SHIFT_LEFT_PREV_AD_CTRLC_COLOR_MODE
    PEA     300.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    PEA     GLOB_STR_CTRLF_FOREGROUND_CTRLB_BACKGROUND
    PEA     330.W
    PEA     40.W
    MOVE.L  GLOB_REF_RASTPORT_1,-(A7)
    JSR     DISPLAY_TEXT_AT_POSITION(PC)

    LEA     80(A7),A7

    MOVEA.L GLOB_REF_RASTPORT_1,A1
    MOVEQ   #1,D0
    MOVEA.L GLOB_REF_GRAPHICS_LIBRARY,A6
    JSR     _LVOSetDrMd(A6)

    MOVEM.L (A7)+,D2-D3
    RTS

;!======

    ; Alignment
    ALIGN_WORD

;!======

LAB_0858:
    JMP     LAB_0EE5

LAB_0859:
    JMP     LAB_0EE9

LAB_085A:
    JMP     LAB_0EDB

LAB_085B:
    JMP     ESQ_WriteDecFixedWidth

LAB_085C:
    JMP     LAB_0EAF

LAB_085D:
    JMP     LAB_0EE8
